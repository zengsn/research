Codes from referenced algorithms for convenient reading.
